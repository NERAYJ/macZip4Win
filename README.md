# macZip4Win

**Mac で作った ZIP を Windows で開くと「ファイル名が文字化け…」**  
そんな地味にストレスを感じていた問題を、Finder の右クリック一発で解決する Automator クイックアクションです。

「相手が Windows だから、怖くて英数字にリネームして送ってる」  
「ZIP を渡すたびに『文字化けしてる』と言われる」  
そんな手間、ここで終わりにしましょう。

## できること

- Finder の右クリックから、**Windows で文字化けしにくい ZIP** を作成
- 日本語のファイル名やフォルダ名をそのまま渡せる
- 余計な Mac 固有ファイル（`.DS_Store` / `__MACOSX` など）を自動で除外

## 使い方（3 分で完了）

1. Automator を開く
2. 新規作成で「クイックアクション」を選択
3. 画面上部の設定を以下のように変更
   - ワークフローが受け取る現在の項目: `ファイルまたはフォルダ`
   - 検索対象: `Finder`
4. 「シェルスクリプトを実行」アクションを追加
5. シェル: `/bin/zsh`
6. 入力の引き渡し方法: `引数として`
7. `windows-zip-automator.sh` の内容を貼り付ける

これで、Finder でファイルやフォルダを選び、右クリックから ZIP を作成できるようになります。

## 動作の詳細

- 選択した項目と同じ名前で ZIP を作成
- 同一フォルダ内の項目のみ対応（安全のため）
- Windows のエクスプローラーで解凍しても文字化けしにくい形式で作成

## 除外されるファイル

- `.DS_Store`
- `._*`
- `__MACOSX`
- `.Spotlight-V100`
- `.Trashes`

## 注意事項

- 複数のフォルダにまたがる選択はエラーになります
- 同名の ZIP が既に存在する場合は上書きされます

## よくある質問

**Q. なぜ Mac の ZIP は Windows で文字化けするの？**  
A. Mac の標準 ZIP はファイル名のエンコーディングが Windows と相性が悪く、エクスプローラーで文字化けしやすいためです。

**Q. どの Windows でも大丈夫？**  
A. 一般的な Windows 10/11 のエクスプローラーなら問題が起きにくい形式です。

---

「文字化けしてる」という声が減れば嬉しいです。